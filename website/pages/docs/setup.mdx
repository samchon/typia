import { Tabs, Tab } from 'nextra-theme-docs'

import Alert from '@mui/material/Alert';
import AlertTitle from '@mui/material/AlertTitle';

# Setup
## Summary
<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" showLineNumbers copy
npm install typia
npx typia setup
```
  </Tab>
  <Tab>
```bash filename="Terminal" showLineNumbers copy
pnpm install typia
pnpm typia setup --manager pnpm
```
  </Tab>
  <Tab>
    <Alert severity="warning">
      Yarn berry is not supported.
    </Alert>
```bash filename="Terminal" showLineNumbers copy
yarn add typia
yarn typia setup --manager yarn
```
  </Tab>
</Tabs>

If you're using standard TypeScript compiler, you can use [transform mode](#transformation).

Assuming you are using [transformation mode] simply run `npx typia setup` which will provide sane defaults.

  - Standard TypeScript Compiler: [Microsoft/TypeScript](https://github.com/microsoft/typescript)

<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" showLineNumbers copy
npm install typia
npm install --save-dev typescript

npx typia generate \
  --input src/templates \
  --output src/generated \
  --project tsconfig.json
```
  </Tab>
  <Tab>
```bash filename="Terminal" showLineNumbers copy
pnpm install typia
pnpm install --save-dev typescript

pnpm typia generate \
  --input src/templates \
  --output src/generated \
  --project tsconfig.json
```
  </Tab>
  <Tab>
```bash filename="Terminal" showLineNumbers copy
yarn add typia
yarn add -D typescript

yarn typia generate \
  --input src/templates \
  --output src/generated \
  --project tsconfig.json
```
  </Tab>
</Tabs>

If you are using a non-standard TypeScript compiler such as the following, you will need to fall back to [generation](#generation) mode

  - Non-standard TypeScript Compilers
    - [SWC](https://swc.rs)
    - [ESBuild](https://esbuild.github.io/)
    - [Babel](https://babeljs.io/)

## Transformation
### Concepts
AOT (Ahead of Time) compilation mode.

When you write a TypeScript code calling `typia.createIs<IMember>()` function and compile it through `tsc` command, `typia` will replace the `typia.createIs<IMember>()` statement to optimal validation code in the compiled JavaScript file, for the `IMember` type. 

This is the transform mode performing AOT (Ahead of Time) compilation.

<Tabs items={['TypeScript Source Code', 'Compiled JavaScript File']}>
  <Tab>
```typescript copy filename="examples/src/check.ts" showLineNumbers {3}
import typia, { tags } from "typia";

export const check = typia.createIs<IMember>();

interface IMember {
  id: string & tags.Format<"uuid">;
  email: string & tags.Format<"email">;
  age: number & tags.ExclusiveMinimum<19> & tags.Maximum<100>;
}
```
  </Tab>
  <Tab>
```javascript filename="examples/bin/check.js" showLineNumbers {2-12}
"use strict";
var __importDefault =
  (this && this.__importDefault) ||
  function (mod) {
    return mod && mod.__esModule ? mod : { default: mod };
  };
Object.defineProperty(exports, "__esModule", { value: true });
exports.check = void 0;
const typia_1 = __importDefault(require("typia"));
const check = (input) => {
  return (
    "object" === typeof input &&
    null !== input &&
    "string" === typeof input.id &&
    /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i.test(
      input.id,
    ) &&
    "string" === typeof input.email &&
    /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i.test(
      input.email,
    ) &&
    "number" === typeof input.age &&
    19 < input.age &&
    input.age <= 100
  );
};
exports.check = check;
```
  </Tab>
</Tabs>

### Setup Wizard
<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
npm install --save typia
npx typia setup
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
pnpm install --save typia
pnpm typia setup --manager pnpm
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# YARN BERRY IS NOT SUPPORTED
yarn add typia
yarn typia setup --manager yarn
```
  </Tab>
</Tabs>

You can turn on transformation mode just by running `npx typia setup` command.

Setup wizard would be executed, and it will do everything for the transformation.

### Manual Setup
<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
npm install --save typia
npm install --save-dev typescript ts-patch ts-node
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
pnpm install --save typia
pnpm install --save-dev typescript ts-patch ts-node
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# YARN BERRY IS NOT SUPPORTED
yarn add typia
yarn add -D typescript ts-patch ts-node
```
  </Tab>
</Tabs>

If you want to install `typia` manually, just follow the steps.

Firstly install `typia` as a dependency. And then, install `typescript`, `ts-patch` and `ts-node` as `devDependencies`.

```json filename="tsconfig.json" copy showLineNumbers
{
  "strict": true,
  "strictNullChecks": true,
  "compilerOptions": {
    "plugins": [
      { "transform": "typia/lib/transform" }
    ]
  }
}
```

Secondly open your `tsconfig.json` file as shown above.

As `typia` generates optimal operation code through transformation, it must be configured as a `plugin`. Also, never forget to configure `strict` (or `strictNullChecks`) to be `true` within your tsconfig.json `compilerOptions`. It is essential option for modern TypeScript development.

```json filename="package.json" copy showLineNumbers {2-4}
{
  "scripts": {
    "prepare": "ts-patch install && typia patch"
  },
  "dependencies": {
    "typia": "^4.1.8"
  },
  "devDependencies": {
    "ts-node": "^10.9.1",
    "ts-patch": "^3.2.0",
    "typescript": "^6.0.6"
  }
}
```

<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
npm run prepare
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
pnpm prepare
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# YARN BERRY IS NOT SUPPORTED
yarn prepare
```
  </Tab>
</Tabs>

Finally open `package.json` file and configure `npm run prepare` command like above.

Be sure to run `npm run prepare` once you have made these changes

For reference, [`ts-patch`](https://github.com/nonara/ts-patch) is an helper library of TypeScript compiler that supporting custom transformations by plugins. From now on, whenever you run `tsc` command, your `typia` function call statements would be transformed to the optimal operation codes in the compiled JavaScript files.

<br/>
<Alert severity="warning">
  <AlertTitle>
    **`npx typia patch`** 
  </AlertTitle> 

Since TypeScript v5.3 update, `tsc` no more parses `JSDocComment`s. Therefore, `typia` also cannot utilize those `JSDocComment` related features too, especially ["Comment Tags"](./validators/tags/#comment-tags) and ["JSON schema generator"](./json/schema). 

The `npx typia patch` command has been developed to revive the `JSDocComment` parsing feature of `tsc`. It is temporary solution for the TypeScript v5.3 update instead of [`ts-patch`](https://github.com/nonara/ts-patch), and will be disabled after [`ts-patch`](https://github.com/nonara/ts-patch) starts supporting such TypeScript v5.3 update.

Of course, if you don't use any ["Comment Tags"](./validators/tags/#comment-tags) and ["JSON schema generator"](./json/schema), you don't need to run `npx typia patch` command. This is not mandatory command, but just optional command.

</Alert>




## Generation
<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# INSTALL TYPIA
npm install --save typia
npm install --save-dev typescript

# GENERATE TRANSFORMED TYPESCRIPT CODES
npx typia generate \
  --input src/templates \
  --output src/generated \
  --project tsconfig.json
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# INSTALL TYPIA
pnpm install --save typia
pnpm install --save-dev typescript

# GENERATE TRANSFORMED TYPESCRIPT CODES
pnpm typia generate \
  --input src/templates \
  --output src/generated \
  --project tsconfig.json
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# INSTALL TYPIA
yarn add typia
yarn add -D typescript

# GENERATE TRANSFORMED TYPESCRIPT CODES
yarn typia generate \
  --input src/templates \
  --output src/generated \
  --project tsconfig.json
```
  </Tab>
</Tabs>

For frontend projects.

If you are using a non-standard TypeScript compiler such as the following, you will need to fall back to [generation](#generation) mode

  - Non-standard TypeScript compilers:
    - [SWC](https://swc.rs/) in Next.JS
    - [ESBuild](https://esbuild.github.io/) in Vite
    - [Babel](https://babeljs.io/) in Create-React-App

Instead you should utilise the generation mode. 

Install `typia` through `npm install` command, and run `typia generate` command. Then, generator of `typia` reads your TypeScript codes of `--input`, and writes transformed TypeScript files into the `--output` directory, like below.

For clarification, the input directory should contain one or more TypeScript files which define how you want to verify your associated type assertions. Commonly you will import your TypeScript type, then export a function which validates that type. See below.

If you want to specify other TypeScript project file instead of `tsconfig.json`, you can use `--project` option.

<Tabs items={['TypeScript Source Code', 'Generated TypeScript File']}>
  <Tab>
```typescript copy filename="examples/src/templates/check.ts" showLineNumbers {5}
import typia from "typia";

import { IMember } from "../structures/IMember";

export const check = typia.createIs<IMember>();
```
  </Tab>
  <Tab>
```typescript copy filename="examples/src/generated/check.ts" showLineNumbers {3-13}
import typia from "typia";
import { IMember } from "../structures/IMember";
export const check = (input: any): input is IMember => {
  const $is_uuid = (typia.createIs as any).is_uuid;
  const $is_email = (typia.createIs as any).is_email;
  return (
    "object" === typeof input &&
    null !== input &&
    "string" === typeof input.id &&
    $is_uuid(input.id) &&
    "string" === typeof input.email &&
    $is_email(input.email) &&
    "number" === typeof input.age &&
    19 <= input.age &&
    100 >= input.age
  );
};
```
  </Tab>
</Tabs>

<br/>
<Alert severity="info">
  <AlertTitle>
    **Why not support non-standard compilers?**
  </AlertTitle>

Non-standard TypeScript compilers are removing every type informations, and skipping type checkings for rapid compilation. By the way, without those type informations, `typia` can't do anything. This is the reason why `typia` doesn't support non-standard TypeScript compilers.

By the way, [SWC](https://swc.rs) is preparing a new project [STC](https://github.com/dudykr/stc) keeping type informations. Therefore, `typia` will support it.

</Alert>




## Vite
If you've made your frontend project through `vite`, you can still utilize the [transformation](#transformation) mode.

Just configure `vite.config.ts` file below, that's all.

```typescript filename="vite.config.ts" copy showLineNumbers
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import typescript from "rollup-plugin-typescript2";

// https://vitejs.dev/config/
export default defineConfig({
  esbuild: false,
  plugins: [
    react(),
    typescript(),
  ],
});
```

By the way, if you're composing monorepo, and need to import some external TypeScript files from the other package of the monorepo, you've to configure the `vite.config.ts` a little bit different. When declaring `typescript` plugin, you've to specify `include` and `exclude` options like below.

```typescript filename="vite.config.ts" copy showLineNumbers
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import typescript from "rollup-plugin-typescript2";

// https://vitejs.dev/config/
export default defineConfig({
  esbuild: false,
  plugins: [
    react(),
    typescript({
      // WHEN MONOREPO
      include: [
        "./**/*.ts+(|x)",
        "../../core/**/*.ts+(|x)",
        "../../util/**/*.ts+(|x)",
      ],
      exclude: ["../../node_modules"],
    }),
  ],
});
```




## Webpack
<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# TYPIA
npm install typia
npx typia setup

# WEBPACK + TS-LOADER
npm install --save-dev ts-loader
npm install --save-dev webpack webpack-cli
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# TYPIA
pnpm install typia
pnpm typia setup --manager pnpm

# WEBPACK + TS-LOADER
pnpm install --save-dev ts-loader
pnpm install --save-dev webpack webpack-cli
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
###########################################
# YARN BERRY IS NOT SUPPORTED
###########################################
# TYPIA
yarn add typia
yarn typia setup --manager yarn

# WEBPACK + TS-LOADER
yarn add -D ts-loader
yarn add -D webpack webpack-cli
```
  </Tab>
</Tabs>

When you're using `webpack` as a bundler, you can still utilize the [transformation](#transformation) mode.

Just install `ts-loader` as well as `webpack`, and configure `webpack.config.js` file like below.

```javascript filename="webpack.config.js" copy showLineNumbers {20-24}
const path = require("path");
const nodeExternals = require("webpack-node-externals");

module.exports = {
  // CUSTOMIZE HERE
  entry: ["./src/index.tsx"],
  output: {
    path: path.join(__dirname, "dist"),
    filename: "index.js",
  },
  optimization: {
    minimize: false,
  },

  // JUST KEEP THEM
  mode: "development",
  target: "node",
  module: {
    rules: [
      {
        test: /\.ts$/,
        exclude: /node_modules/,
        loader: "ts-loader",
      },
    ],
  },
  resolve: {
    extensions: [".tsx", ".ts", ".js"],
  },
};
```

From now on, you can build the single JS file just by running the `npx webpack` command. By the way, when removing `devDependencies` for `--production` install, never forget to add the `--ignore-scripts` option to prevent the `prepare` script.

<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
npx webpack
npm ci --omit=dev --ignore-scripts
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
pnpm webpack
pnpm install --production --ignore-scripts
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
yarn webpack
rm -rf node_modules
yarn install --production --ignore-scripts --immutable
```
  </Tab>
</Tabs>

Additionally, if you're using `typia` in the NodeJS project especially for the backend development, *Setup Guide Documents* of [`nestia`](https://github.com/samchon/nestia) would be helpful. Even though you're not using NestJS, you can still utilize below documents, and "Single JS file only" mode would be especially helpful for you.

  - [Nestia > Setup > Webpack](https://nestia.io/docs/setup/#webpack)
    - [With `node_modules`](https://nestia.io/docs/setup/#with-node_modules)
    - [Single JS file only](https://nestia.io/docs/setup/#single-js-file-only)


## NX
<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
npm install --save typia
npx typia setup
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
pnpm install --save typia
pnpm typia setup --manager pnpm
```
  </Tab>
  <Tab>
```bash filename="Terminal" copy showLineNumbers
# YARN BERRY IS NOT SUPPORTED
yarn add typia
yarn typia setup --manager yarn
```
  </Tab>
</Tabs>

After install `typia` like above, you have to modify `project.json` on each app like below.

```javascript filename="project.json" showLineNumbers copy
 "targets": {
    "build": {
      ...
      "options": {
        ...
        "target": "node",
        "compiler": "tsc",
        "transformers": [
          "typia/lib/transform",
        ]
      }
    },
    ...
 }
```
